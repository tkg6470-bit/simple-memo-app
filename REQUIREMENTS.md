\# **\*\*📋 要件定義書 (System Requirements Specification)\*\***

Project Name: Simple Memo App (Enhanced Edition)  
Version: 1.5.0 (Dev Container Supported)  
本ドキュメントは、モダンな自社開発企業が採用する技術スタックと開発フローを再現した、フルスタックメモアプリケーションの要件を定義するものである。

\#\# **\*\*1. プロジェクト概要\*\***

\#\#\# **\*\*1.1 目的\*\***  
\- **\*\*技術力の証明\*\***: 未経験から即戦力レベルのモダン技術（TypeScript, Docker, AWS, AI 連携）に加え、**\*\*Dev Containers を用いた高度な環境構築能力\*\***を証明する。

\#\#\# **\*\*1.2 予算戦略\*\***  
\- **\*\*開発フェーズ\*\***: 完全無料 (Docker Desktop 利用)  
\- **\*\*運用フェーズ\*\***: 従量課金リソース（AWS App Runner 等）はデモ時以外停止し、コストを最小化する。

\#\# **\*\*2. 機能要件 (Functional Requirements)\*\***

\#\#\# **\*\*2.1 基本機能 (Core Features)\*\***  
| ID | 機能名 | 実装状況 | 詳細 |  
| :------- | :----------- | :------- | :------------------------------- |  
| **\*\*F-01\*\*** | **\*\*メモ作成\*\*** | ✅ 完了 | タイトル・本文を入力し保存する。 |  
| **\*\*F-02\*\*** | **\*\*メモ閲覧\*\*** | ✅ 完了 | 作成日順での一覧表示。 |  
| **\*\*F-03\*\*** | **\*\*メモ削除\*\*** | ✅ 完了 | 不要なメモを削除する。 |  
| **\*\*F-04\*\*** | **\*\*メモ編集\*\*** | 未実装 | 既存メモの内容を修正・更新する。 |

\#\#\# **\*\*2.2 認証・認可 (Auth)\*\***  
| ID | 機能名 | 詳細 |  
| :------- | :------------------------ | :------------------------------------------------------- |  
| **\*\*F-05\*\*** | **\*\*ユーザー登録/ログイン\*\*** | Clerk/Auth0 を用いたセキュアな認証。 |  
| **\*\*F-06\*\*** | **\*\*データ分離\*\*** | ログインユーザー自身のデータのみにアクセス権を限定する。 |

\#\#\# **\*\*2.3 AI・高度機能 (Advanced Features)\*\***  
| ID | 機能名 | 詳細 |  
| :------- | :--------------------- | :-------------------------------------------------------- |  
| **\*\*F-07\*\*** | **\*\*AI 自動要約\*\*** | OpenAI API を利用し、長文メモを 3 行で要約して保存する。 |  
| **\*\*F-08\*\*** | **\*\*ベクトル検索 (RAG)\*\*** | pgvector を利用し、意味検索を実現する。 |  
| **\*\*F-09\*\*** | **\*\*MCP サーバー連携\*\*** | AI エージェントからメモを操作可能にするインターフェース。 |

\#\# **\*\*3. 非機能要件 (Non-Functional Requirements)\*\***

\#\#\# **\*\*3.1 セキュリティ & インフラ\*\***  
\- **\*\*機密情報\*\***: .env 管理を徹底し、コードベースに含めない。  
\- **\*\*入力値検証\*\***: Zod による厳格なバリデーションを実施。  
\- **\*\*可用性\*\***: AWS App Runner (コンテナ) \+ RDS (DB) \+ S3 (ストレージ) の構成を想定。

\#\#\# **\*\*3.2 品質・保守性\*\***  
\- **\*\*型安全性\*\***: TypeScript を全面採用し、\`any\` 型の使用を原則禁止する。  
\- **\*\*アーキテクチャ\*\***: 「関心の分離」に基づき、ルーティング、コントローラー、サービス層を分離する。  
\- **\*\*テスト\*\***: Vitest (単体) / Playwright (E2E) の実装。

\#\#\# **\*\*3.3 パフォーマンス目標\*\***  
\- **\*\*API レスポンス\*\***: 通常の CRUD 操作は **\*\*500ms 以内\*\*** にレスポンスを返すこと。  
\- **\*\*AI 処理\*\***: 時間のかかる AI 処理（数秒〜）は非同期で行い、UI をブロックしないこと。

\#\# **\*\*4. UI/UX ガイドライン (User Interface & Experience)\*\***

\#\#\# **\*\*4.1 デザイン原則\*\***  
\- **\*\*モバイルファースト\*\***: スマートフォンでの操作（タップしやすさ、画面幅への追従）を最優先に設計する。  
\- **\*\*シンプル＆ミニマル\*\***: 学習コストのかからない直感的な UI を目指す。過度な装飾は避ける。

\#\#\# **\*\*4.2 画面構成案\*\***  
1\. **\*\*認証画面\*\***: ログイン / サインアップ（Clerk 提供 UI を使用）。  
2\. **\*\*ダッシュボード（一覧）\*\***:  
 \- メモのカード表示（タイトル、要約、更新日）。  
 \- 新規作成ボタン（FAB: Floating Action Button）。  
 \- 検索バー（AI 意味検索対応）。  
3\. **\*\*編集・詳細画面\*\***:  
 \- タイトル・本文の入力エリア。  
 \- 画像アップロードエリア。  
 \- AI 要約ボタン。

\#\# **\*\*5. システム設計詳細 (System Design)\*\***

\#\#\# **\*\*5.1 技術スタック\*\***  
\- **\*\*Frontend\*\***: React (Vite), Axios, Tailwind CSS  
\- **\*\*Backend\*\***: Node.js (Express), Prisma  
\- **\*\*Database\*\***: PostgreSQL (Docker / pgvector)  
\- **\*\*Infrastructure\*\***: Docker Compose, **\*\*Dev Containers\*\***, AWS (App Runner, S3), Terraform  
\- **\*\*Language\*\***: TypeScript

\#\#\# **\*\*5.2 データモデル (ER Diagram)\*\***  
\`\`\`mermaid  
erDiagram  
 User ||--o{ Memo : "has many"  
 User {  
 string id PK "Auth Provider ID"  
 string email  
 string name  
 }  
 Memo {  
 int id PK  
 string user_id FK  
 string title  
 string content  
 string image_url "S3 URL"  
 vector embedding "For AI Search"  
 datetime created_at  
 datetime updated_at  
 }

### **5.3 ディレクトリ構成設計 (Refactoring Target)**

現在の index.ts 一極集中から、以下の構成へリファクタリングを行う。

backend/src/  
├── config/ \# 環境変数や DB 接続設定  
├── controllers/ \# リクエスト処理・レスポンス返却  
├── routes/ \# API ルーティング定義  
├── services/ \# ビジネスロジック (AI 処理など)  
├── utils/ \# 共通関数 (バリデーション等)  
├── app.ts \# Express 設定  
└── index.ts \# エントリーポイント

### **5.4 API インターフェース詳細**

Base URL: /api

| Method | Endpoint             | Request Body         | Response (200/201)  |
| :----- | :------------------- | :------------------- | :------------------ |
| GET    | /memos               | \-                   | Memo\[\]            |
| POST   | /memos               | { title, content }   | Memo                |
| GET    | /memos/:id           | \-                   | Memo                |
| PUT    | /memos/:id           | { title?, content? } | Memo                |
| DELETE | /memos/:id           | \-                   | (Empty)             |
| POST   | /memos/:id/summarize | \-                   | { summary: string } |

## **6\. 開発運用ルール (Development & Operations Rules)**

### **6.1 環境分離 (Environment Isolation)**

- **Dev Containers**: ホストマシン（Mac）には Node.js や npm をインストールせず、全ての開発作業を Docker コンテナ内で行うことを絶対ルールとする。
- **VS Code**: 拡張機能（ESLint, Prettier 等）もコンテナ内に定義し、開発者間で環境差異が生まれないようにする。

### **6.2 バージョン管理・ブランチ戦略**

- **フロー**: GitHub Flow (main \+ feature ブランチ)。
- **コミットメッセージ**: Feat:, Fix:, Refactor:, Docs: 等のプレフィックスを付与する。

### **6.3 エラーハンドリング設計**

API は以下の HTTP ステータスコードを適切に返却し、フロントエンドはこれに基づいて UI を制御する。

| コード      | 意味           | フロントエンドの挙動                             |
| :---------- | :------------- | :----------------------------------------------- |
| **200/201** | OK/Created     | 成功メッセージを表示または画面遷移。             |
| **400**     | Bad Request    | 入力エラー箇所をハイライト表示（Zod 連携）。     |
| **401**     | Unauthorized   | ログイン画面へリダイレクト。                     |
| **404**     | Not Found      | 404 ページまたは一覧へリダイレクト。             |
| **500**     | Internal Error | 「システムエラーが発生しました」とトースト表示。 |

## **7\. 制約事項・前提条件 (Constraints)**

- **ブラウザサポート**: Google Chrome, Safari, Edge, Firefox の最新版のみをサポート対象とする（IE 等は非対応）。
- **言語対応**: 日本語のみとする。
- **依存サービス**: OpenAI API 等の外部サービスが停止した場合、AI 機能は利用不可となるが、基本的なメモ機能は継続して利用できる設計とする（Graceful Degradation）。

Created by \[Your Name\] \- 2025
