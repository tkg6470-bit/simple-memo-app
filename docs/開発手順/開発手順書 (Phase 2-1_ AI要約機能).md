# **📘 開発手順書 (Phase 2-1: AI要約機能)**

本フェーズでは、メモの内容を AI が自動で要約する機能を実装した。  
（※現在はコスト抑制のため、OpenAI API の代わりにモック機能で動作確認を行っている）

## **🎯 1\. 目的**

* **付加価値の提供**: 単なるメモ帳ではなく、AI を活用したモダンなアプリであることを示す。  
* **外部API連携**: バックエンドからサードパーティの API (OpenAI) を呼び出すアーキテクチャを構築する。

## **🛠️ 2\. 実装内容**

### **2.1 環境構築**

* openai ライブラリをバックエンドにインストール。  
* .env に OPENAI\_API\_KEY を追加し、docker-compose.yml 経由でコンテナに渡す設定を行った。

### **2.2 AIサービス層 (services/aiService.ts)**

* OpenAI API を呼び出すロジックを分離して実装。  
* 現在はモックモードとして、1秒の遅延後にダミーテキストを返す仕様にしている。  
* 将来的には、コメントアウトを解除するだけで本物の GPT-3.5/4 が動作する状態になっている。

// 将来の拡張用コード  
const response \= await openai.chat.completions.create({ ... });

### **2.3 コントローラーとルート (memoController.ts, memoRoutes.ts)**

* POST /memos/:id/summarize というエンドポイントを作成。  
* userId を検証し、自分のメモである場合のみ要約処理を実行するガードをかけた。

### **2.4 フロントエンド (App.tsx)**

* 各メモに「✨ AI要約」ボタンを配置。  
* ボタン押下時に API をコールし、ローディング状態 (思考中...) を表示。  
* 結果が返ってきたら、メモの下に青いエリアで要約を表示する UI を実装した。

## **✅ 3\. 成果**

* 「ボタンを押すと AI が答えてくれる」というインタラクティブな体験を実装できた。  
* バックエンド、フロントエンド、データベース、外部API連携（準備含む）のすべてが有機的に動作する状態になった。